<ion-view view-title="{{ appVm.text[vm.titleKey] }}">

    <ion-content class="has-header areas">
        <ion-refresher pulling-text="{{appVm.text['pullToRefresh']}}" on-refresh="vm.pullToRefresh()">
        </ion-refresher>

        <leaflet data-tap-disabled="true" class="map" lf-center="vm.map.center" defaults="vm.map.defaults"
                 tiles="vm.map.tiles"
                 geojson="vm.map.geojson"
                 width="100%" height="100%" ng-if="vm.hasMap">

        </leaflet>

        <div class="list selected-area" ng-if="vm.map.selectedArea">

            <div class="item item-divider shadow-top">
                {{vm.map.selectedArea.name}}
                {{appVm.util.getDayRangeString(appVm.util.getDays(vm.map.selectedArea.landslideForecast))}}
            </div>

            <a class="item item-icon-right" ng-click="vm.goToArea(vm.area)">
                <forecast-widget forecast="vm.map.selectedArea.floodForecast"
                                 label="appVm.text['flood']"></forecast-widget>
                <br/>
                <forecast-widget forecast="vm.map.selectedArea.landslideForecast"
                                 label="appVm.text['landslide']"></forecast-widget>
                <i class="icon icon-accessory ion-chevron-right"></i>
            </a>

        </div>

        <div class="list" ng-class="{'has-map': vm.hasMap}" ng-hide="vm.map.fullscreen">

            <div class="item item-divider shadow-top">
                {{appVm.text['threeDayForecast']}}
                {{appVm.util.getDayRangeString(appVm.util.getDays(vm.areas[0].forecast))}}
            </div>

            <a class="item region item-icon-right" ng-repeat="area in vm.areas" ng-click="vm.goToArea(area)">

                <forecast-widget forecast="area.forecast" label="area.name"></forecast-widget>

                <i class="icon icon-accessory ion-chevron-right"></i>
            </a>

        </div>

    </ion-content>
</ion-view>

<script type="text/ng-template" id="/templates/forecast-widget.html">
    <hazard-rating warning="warning" ng-repeat="warning in forecast"></hazard-rating>
    <span class="varsom-warning-text" ng-bind="label"></span>
</script>